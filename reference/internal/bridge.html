<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="article:modified_time" content="2025-05-28T17:07:54+00:00" /><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Distribution" href="distribution.html" /><link rel="prev" title="Bisect" href="bisect.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Bridges - pfl 0.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">pfl 0.3.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">pfl 0.3.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../guides/fl_introduction.html">Federated learning with pfl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/simulation_distributed.html">Fast distributed simulations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../algorithm.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aggregate.html">Backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aggregate.html#aggregator">Aggregator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aggregate.html#module-pfl.aggregate.data_transport">Data transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aggregate.html#module-pfl.aggregate.weighting">Weighting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../callback.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common_types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exception.html">Exception</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperparam.html">Hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postprocessor.html">Postprocessor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../privacy.html">Differential privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stats.html">Training statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tree.html">Gradient boosted decision trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environment_variables.html">Environment variables</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Internal API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Internal API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bisect.html">Bisect</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Bridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="distribution.html">Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops.html">Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="platform.html">Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="privacy_loss_bound.html">Privacy loss bound</a></li>
<li class="toctree-l2"><a class="reference internal" href="tree.html">Tree</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="bridges">
<h1>Bridges<a class="headerlink" href="#bridges" title="Link to this heading">#</a></h1>
<section id="module-pfl.internal.bridge.base">
<span id="bridge-base-classes"></span><h2>Bridge base classes<a class="headerlink" href="#module-pfl.internal.bridge.base" title="Link to this heading">#</a></h2>
<p>This module contains abstract interfaces that act as
bridges between framework-agnostic code and specific
deep learning frameworks.</p>
<p>Extending <code class="docutils literal notranslate"><span class="pre">CommonFrameworkBridge</span></code> is required at a minimum for simulations
to support a deep learning framework. Additional bridges can be
implemented to support additional algorithms and deep learning frameworks.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">pfl.internal.ops</span></code>, but distinct for these reasons:</p>
<ul class="simple">
<li><p>Ops module is the lowest module of primitive framework-specific code that can
be injected anywhere in the code. It does not depend on any other modules.</p></li>
<li><p>This module works similar to ops module, but can have dependencies on data
structures like Statistics, Metrics, Dataset, Model.
Since ops module does not have any pfl components as dependencies, it
can be used in the implementation of the data structures mentioned, while
this module of bridges is restricted to higher-level components which it
does not self-reference, e.g. Algorithm and Privacy mechanism.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.CommonFrameworkBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.base.</span></span><span class="sig-name descname"><span class="pre">CommonFrameworkBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.CommonFrameworkBridge" title="Link to this definition">#</a></dt>
<dd><p>Functions that need framework-specific implementations and
that are required for rudimentary support of that deep learning framework
in pfl.
All other bridges than this interface are optional for supporting
certain algorithms.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.CommonFrameworkBridge.save_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.CommonFrameworkBridge.save_state" title="Link to this definition">#</a></dt>
<dd><p>Save <code class="docutils literal notranslate"><span class="pre">state</span></code> to disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.CommonFrameworkBridge.load_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.CommonFrameworkBridge.load_state" title="Link to this definition">#</a></dt>
<dd><p>Load state from disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.SGDFrameworkBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.base.</span></span><span class="sig-name descname"><span class="pre">SGDFrameworkBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.SGDFrameworkBridge" title="Link to this definition">#</a></dt>
<dd><p>Interface for functions that manipulate the model using
stochastic gradient descent and need framework-specific
implementations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.SGDFrameworkBridge.do_sgd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.SGDFrameworkBridge.do_sgd" title="Link to this definition">#</a></dt>
<dd><p>Do multiple epochs of SGD with the given input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">StatefulModelType_contra</span></code>, bound= <a class="reference internal" href="../model.html#pfl.model.base.StatefulModel" title="pfl.model.base.StatefulModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">StatefulModel</span></code></a>, contravariant=True)) – The model to train.</p></li>
<li><p><strong>user_dataset</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">AbstractDatasetType</span></code>, bound= AbstractDataset)) – Dataset of type <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> to train on.</p></li>
<li><p><strong>train_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">ModelHyperParamsType_contra</span></code>, bound= <a class="reference internal" href="../hyperparam.html#pfl.hyperparam.base.ModelHyperParams" title="pfl.hyperparam.base.ModelHyperParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelHyperParams</span></code></a>, contravariant=True)) – An instance of <a class="reference internal" href="../hyperparam.html#pfl.hyperparam.base.ModelHyperParams" title="pfl.hyperparam.base.ModelHyperParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelHyperParams</span></code></a>
containing configuration for training.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.FedProxFrameworkBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.base.</span></span><span class="sig-name descname"><span class="pre">FedProxFrameworkBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.FedProxFrameworkBridge" title="Link to this definition">#</a></dt>
<dd><p>Interface for implementing the FedProx algorithm, by
T. Li. et al. - Federated Optimization in Heterogeneous Networks
(<a class="reference external" href="https://arxiv.org/pdf/1812.06127.pdf">https://arxiv.org/pdf/1812.06127.pdf</a>),
for a particular Deep Learning framework.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.FedProxFrameworkBridge.do_proximal_sgd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_proximal_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.FedProxFrameworkBridge.do_proximal_sgd" title="Link to this definition">#</a></dt>
<dd><p>Do multiple local epochs of SGD with the FedProx
proximal term added to the loss (Equation 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.SCAFFOLDFrameworkBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.base.</span></span><span class="sig-name descname"><span class="pre">SCAFFOLDFrameworkBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.SCAFFOLDFrameworkBridge" title="Link to this definition">#</a></dt>
<dd><p>Interface for implementing the SCAFFOLD algorithm, by
S. P. Karimireddy et al. - SCAFFOLD: Stochastic Controlled Averaging
for Federated Learning.
(<a class="reference external" href="https://proceedings.mlr.press/v119/karimireddy20a/karimireddy20a.pdf">https://proceedings.mlr.press/v119/karimireddy20a/karimireddy20a.pdf</a>),
for a particular Deep Learning framework.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.SCAFFOLDFrameworkBridge.do_control_variate_sgd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_control_variate_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server_c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.SCAFFOLDFrameworkBridge.do_control_variate_sgd" title="Link to this definition">#</a></dt>
<dd><p>Do multiple local epochs of SGD with local control
variate ($c_i$) and server control variate ($c$),
see Algorithm 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.FTRLFrameworkBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.base.</span></span><span class="sig-name descname"><span class="pre">FTRLFrameworkBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.FTRLFrameworkBridge" title="Link to this definition">#</a></dt>
<dd><p>Interface for implementing factorizing banded matrix for FTRL mechanism, by
Choquette-Choo et al. - (Amplified) Banded Matrix Factorization: A unified
approach to private training (<a class="reference external" href="https://arxiv.org/pdf/2306.08153.pdf">https://arxiv.org/pdf/2306.08153.pdf</a>),
for a particular deep Learning framework.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.FTRLFrameworkBridge.loss_and_gradient">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss_and_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.FTRLFrameworkBridge.loss_and_gradient" title="Link to this definition">#</a></dt>
<dd><p>Computes the loss $     r[A^T A X^{-1}]$ and the associated gradient
$dX = -X^{-1} A^T A X^{-1}$ from the optimization problem in Equation 6
in <a class="reference external" href="https://arxiv.org/pdf/2306.08153.pdf">https://arxiv.org/pdf/2306.08153.pdf</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>), <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>)]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.FTRLFrameworkBridge.lbfgs_direction">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lbfgs_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_dX</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.FTRLFrameworkBridge.lbfgs_direction" title="Link to this definition">#</a></dt>
<dd><p>Given the current/previous iterates (X and X1) and the current/previous
gradients (dX and dX1), compute a search direction (Z) according to the
LBFGS update rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.base.FTRLFrameworkBridge.terminate_fn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">terminate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dX</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.base.FTRLFrameworkBridge.terminate_fn" title="Link to this definition">#</a></dt>
<dd><p>Criterion to terminate optimization based on dX.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pfl.internal.bridge.factory">
<span id="bridge-factory"></span><h2>Bridge Factory<a class="headerlink" href="#module-pfl.internal.bridge.factory" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.factory.FrameworkBridgeFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.factory.</span></span><span class="sig-name descname"><span class="pre">FrameworkBridgeFactory</span></span><a class="headerlink" href="#pfl.internal.bridge.factory.FrameworkBridgeFactory" title="Link to this definition">#</a></dt>
<dd><p>A collection of bridges to deep learning specific
implementations for several algorithms.
The bridge returned depends on the Deep Learning
framework in use.
This way, we can inject framework-specific code
into an algorithm, and only have one implementation
of each algorithm in the public interface, e.g. one
public FedAvg class instead of one for each of TF,
PyTorch, etc.</p>
<p>Each method returns a class with utility functions
for a particular algorithm.</p>
</dd></dl>

</section>
<section id="module-pfl.internal.bridge.numpy.common">
<span id="numpy-bridges"></span><h2>Numpy Bridges<a class="headerlink" href="#module-pfl.internal.bridge.numpy.common" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.numpy.common.NumpyCommonBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.numpy.common.</span></span><span class="sig-name descname"><span class="pre">NumpyCommonBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.numpy.common.NumpyCommonBridge" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.numpy.common.NumpyCommonBridge.save_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.numpy.common.NumpyCommonBridge.save_state" title="Link to this definition">#</a></dt>
<dd><p>Save <code class="docutils literal notranslate"><span class="pre">state</span></code> to disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.numpy.common.NumpyCommonBridge.load_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.numpy.common.NumpyCommonBridge.load_state" title="Link to this definition">#</a></dt>
<dd><p>Load state from disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pfl.internal.bridge.pytorch.common">
<span id="pytorch-bridges"></span><h2>PyTorch Bridges<a class="headerlink" href="#module-pfl.internal.bridge.pytorch.common" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.common.PyTorchCommonBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.pytorch.common.</span></span><span class="sig-name descname"><span class="pre">PyTorchCommonBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.common.PyTorchCommonBridge" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.common.PyTorchCommonBridge.save_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.common.PyTorchCommonBridge.save_state" title="Link to this definition">#</a></dt>
<dd><p>Save <code class="docutils literal notranslate"><span class="pre">state</span></code> to disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.common.PyTorchCommonBridge.load_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.common.PyTorchCommonBridge.load_state" title="Link to this definition">#</a></dt>
<dd><p>Load state from disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

</dd></dl>

<p id="module-pfl.internal.bridge.pytorch.ftrl">Primal optimization algorithms for multi-epoch matrix factorization.
Reference: <a class="reference external" href="https://github.com/google-research/federated/blob/master/multi_epoch_dp_matrix_factorization/multiple_participations/primal_optimization.py">https://github.com/google-research/federated/blob/master/multi_epoch_dp_matrix_factorization/multiple_participations/primal_optimization.py</a>.  # pylint: disable=line-too-long</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.pytorch.ftrl.</span></span><span class="sig-name descname"><span class="pre">PyTorchFTRLBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.loss_and_gradient">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss_and_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.loss_and_gradient" title="Link to this definition">#</a></dt>
<dd><p>Computes the loss $     r[A^T A X^{-1}]$ and the associated gradient
$dX = -X^{-1} A^T A X^{-1}$ from the optimization problem in Equation 6
in <a class="reference external" href="https://arxiv.org/pdf/2306.08153.pdf">https://arxiv.org/pdf/2306.08153.pdf</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.lbfgs_direction">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lbfgs_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_dX</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.lbfgs_direction" title="Link to this definition">#</a></dt>
<dd><p>Given the current/previous iterates (X and X1) and the current/previous
gradients (dX and dX1), compute a search direction (Z) according to the
LBFGS update rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.terminate_fn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">terminate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dX</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.terminate_fn" title="Link to this definition">#</a></dt>
<dd><p>Criterion to terminate optimization based on dX.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-pfl.internal.bridge.pytorch.proximal">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.proximal.PyTorchFedProxBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.pytorch.proximal.</span></span><span class="sig-name descname"><span class="pre">PyTorchFedProxBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.proximal.PyTorchFedProxBridge" title="Link to this definition">#</a></dt>
<dd><p>Concrete implementation of FedProx utilities in PyTorch, used by
FedProx algorithm.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.proximal.PyTorchFedProxBridge.do_proximal_sgd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_proximal_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.proximal.PyTorchFedProxBridge.do_proximal_sgd" title="Link to this definition">#</a></dt>
<dd><p>Do multiple local epochs of SGD with the FedProx
proximal term added to the loss (Equation 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-pfl.internal.bridge.pytorch.sgd">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.sgd.PyTorchSGDBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.pytorch.sgd.</span></span><span class="sig-name descname"><span class="pre">PyTorchSGDBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.sgd.PyTorchSGDBridge" title="Link to this definition">#</a></dt>
<dd><p>Concrete PyTorch implementations of utils for stochastic gradient
descent.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.pytorch.sgd.PyTorchSGDBridge.do_sgd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.pytorch.sgd.PyTorchSGDBridge.do_sgd" title="Link to this definition">#</a></dt>
<dd><p>Do multiple epochs of SGD with the given input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="../model.html#pfl.model.pytorch.PyTorchModel" title="pfl.model.pytorch.PyTorchModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyTorchModel</span></code></a>) – The model to train.</p></li>
<li><p><strong>user_dataset</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">AbstractDatasetType</span></code>, bound= AbstractDataset)) – Dataset of type <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> to train on.</p></li>
<li><p><strong>train_params</strong> (<a class="reference internal" href="../hyperparam.html#pfl.hyperparam.base.NNTrainHyperParams" title="pfl.hyperparam.base.NNTrainHyperParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">NNTrainHyperParams</span></code></a>) – An instance of <a class="reference internal" href="../hyperparam.html#pfl.hyperparam.base.ModelHyperParams" title="pfl.hyperparam.base.ModelHyperParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelHyperParams</span></code></a>
containing configuration for training.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pfl.internal.bridge.tensorflow.common">
<span id="tensorflow-bridges"></span><h2>TensorFlow Bridges<a class="headerlink" href="#module-pfl.internal.bridge.tensorflow.common" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.common.get_or_make_tf_function">
<span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.tensorflow.common.</span></span><span class="sig-name descname"><span class="pre">get_or_make_tf_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.common.get_or_make_tf_function" title="Link to this definition">#</a></dt>
<dd><p>Lookup tf function in cache or create it.
One graph per model with unique uuid is created.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.common.TFCommonBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.tensorflow.common.</span></span><span class="sig-name descname"><span class="pre">TFCommonBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.common.TFCommonBridge" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.common.TFCommonBridge.save_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.common.TFCommonBridge.save_state" title="Link to this definition">#</a></dt>
<dd><p>Save <code class="docutils literal notranslate"><span class="pre">state</span></code> to disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.common.TFCommonBridge.load_state">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.common.TFCommonBridge.load_state" title="Link to this definition">#</a></dt>
<dd><p>Load state from disk at path <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</dd></dl>

</dd></dl>

<p id="module-pfl.internal.bridge.tensorflow.ftrl">Primal optimization algorithms for multi-epoch matrix factorization.
Reference: <a class="reference external" href="https://github.com/google-research/federated/blob/master/multi_epoch_dp_matrix_factorization/multiple_participations/primal_optimization.py">https://github.com/google-research/federated/blob/master/multi_epoch_dp_matrix_factorization/multiple_participations/primal_optimization.py</a>.  # pylint: disable=line-too-long</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.tensorflow.ftrl.</span></span><span class="sig-name descname"><span class="pre">TFFTRLBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.loss_and_gradient">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loss_and_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.loss_and_gradient" title="Link to this definition">#</a></dt>
<dd><p>Computes the loss $     r[A^T A X^{-1}]$ and the associated gradient
$dX = -X^{-1} A^T A X^{-1}$ from the optimization problem in Equation 6
in <a class="reference external" href="https://arxiv.org/pdf/2306.08153.pdf">https://arxiv.org/pdf/2306.08153.pdf</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.lbfgs_direction">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lbfgs_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_dX</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.lbfgs_direction" title="Link to this definition">#</a></dt>
<dd><p>Given the current/previous iterates (X and X1) and the current/previous
gradients (dX and dX1), compute a search direction (Z) according to the
LBFGS update rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.terminate_fn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">terminate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dX</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.terminate_fn" title="Link to this definition">#</a></dt>
<dd><p>Criterion to terminate optimization based on dX.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-pfl.internal.bridge.tensorflow.proximal">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.proximal.TFFedProxBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.tensorflow.proximal.</span></span><span class="sig-name descname"><span class="pre">TFFedProxBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.proximal.TFFedProxBridge" title="Link to this definition">#</a></dt>
<dd><p>Concrete implementation of FedProx utilities in TF2, used by
FedProx algorithm.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.proximal.TFFedProxBridge.do_proximal_sgd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_proximal_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.proximal.TFFedProxBridge.do_proximal_sgd" title="Link to this definition">#</a></dt>
<dd><p>Do multiple local epochs of SGD with the FedProx
proximal term added to the loss (Equation 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-pfl.internal.bridge.tensorflow.sgd">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.sgd.TFSGDBridge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.internal.bridge.tensorflow.sgd.</span></span><span class="sig-name descname"><span class="pre">TFSGDBridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.sgd.TFSGDBridge" title="Link to this definition">#</a></dt>
<dd><p>Concrete TF implementations of utils for stochastic gradient
descent.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.internal.bridge.tensorflow.sgd.TFSGDBridge.do_sgd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_sgd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.internal.bridge.tensorflow.sgd.TFSGDBridge.do_sgd" title="Link to this definition">#</a></dt>
<dd><p>Do multiple epochs of SGD with the given input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="../model.html#pfl.model.tensorflow.TFModel" title="pfl.model.tensorflow.TFModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TFModel</span></code></a>) – The model to train.</p></li>
<li><p><strong>user_dataset</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">AbstractDatasetType</span></code>, bound= AbstractDataset)) – Dataset of type <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> to train on.</p></li>
<li><p><strong>train_params</strong> (<a class="reference internal" href="../hyperparam.html#pfl.hyperparam.base.NNTrainHyperParams" title="pfl.hyperparam.base.NNTrainHyperParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">NNTrainHyperParams</span></code></a>) – An instance of <a class="reference internal" href="../hyperparam.html#pfl.hyperparam.base.ModelHyperParams" title="pfl.hyperparam.base.ModelHyperParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelHyperParams</span></code></a>
containing configuration for training.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="distribution.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Distribution</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="bisect.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Bisect</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024 Apple Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on May 28, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Bridges</a><ul>
<li><a class="reference internal" href="#module-pfl.internal.bridge.base">Bridge base classes</a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.base.CommonFrameworkBridge"><code class="docutils literal notranslate"><span class="pre">CommonFrameworkBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.base.CommonFrameworkBridge.save_state"><code class="docutils literal notranslate"><span class="pre">CommonFrameworkBridge.save_state()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.base.CommonFrameworkBridge.load_state"><code class="docutils literal notranslate"><span class="pre">CommonFrameworkBridge.load_state()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.base.SGDFrameworkBridge"><code class="docutils literal notranslate"><span class="pre">SGDFrameworkBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.base.SGDFrameworkBridge.do_sgd"><code class="docutils literal notranslate"><span class="pre">SGDFrameworkBridge.do_sgd()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.base.FedProxFrameworkBridge"><code class="docutils literal notranslate"><span class="pre">FedProxFrameworkBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.base.FedProxFrameworkBridge.do_proximal_sgd"><code class="docutils literal notranslate"><span class="pre">FedProxFrameworkBridge.do_proximal_sgd()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.base.SCAFFOLDFrameworkBridge"><code class="docutils literal notranslate"><span class="pre">SCAFFOLDFrameworkBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.base.SCAFFOLDFrameworkBridge.do_control_variate_sgd"><code class="docutils literal notranslate"><span class="pre">SCAFFOLDFrameworkBridge.do_control_variate_sgd()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.base.FTRLFrameworkBridge"><code class="docutils literal notranslate"><span class="pre">FTRLFrameworkBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.base.FTRLFrameworkBridge.loss_and_gradient"><code class="docutils literal notranslate"><span class="pre">FTRLFrameworkBridge.loss_and_gradient()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.base.FTRLFrameworkBridge.lbfgs_direction"><code class="docutils literal notranslate"><span class="pre">FTRLFrameworkBridge.lbfgs_direction()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.base.FTRLFrameworkBridge.terminate_fn"><code class="docutils literal notranslate"><span class="pre">FTRLFrameworkBridge.terminate_fn()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.internal.bridge.factory">Bridge Factory</a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.factory.FrameworkBridgeFactory"><code class="docutils literal notranslate"><span class="pre">FrameworkBridgeFactory</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.internal.bridge.numpy.common">Numpy Bridges</a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.numpy.common.NumpyCommonBridge"><code class="docutils literal notranslate"><span class="pre">NumpyCommonBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.numpy.common.NumpyCommonBridge.save_state"><code class="docutils literal notranslate"><span class="pre">NumpyCommonBridge.save_state()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.numpy.common.NumpyCommonBridge.load_state"><code class="docutils literal notranslate"><span class="pre">NumpyCommonBridge.load_state()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.internal.bridge.pytorch.common">PyTorch Bridges</a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.common.PyTorchCommonBridge"><code class="docutils literal notranslate"><span class="pre">PyTorchCommonBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.common.PyTorchCommonBridge.save_state"><code class="docutils literal notranslate"><span class="pre">PyTorchCommonBridge.save_state()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.common.PyTorchCommonBridge.load_state"><code class="docutils literal notranslate"><span class="pre">PyTorchCommonBridge.load_state()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge"><code class="docutils literal notranslate"><span class="pre">PyTorchFTRLBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.loss_and_gradient"><code class="docutils literal notranslate"><span class="pre">PyTorchFTRLBridge.loss_and_gradient()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.lbfgs_direction"><code class="docutils literal notranslate"><span class="pre">PyTorchFTRLBridge.lbfgs_direction()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.ftrl.PyTorchFTRLBridge.terminate_fn"><code class="docutils literal notranslate"><span class="pre">PyTorchFTRLBridge.terminate_fn()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.proximal.PyTorchFedProxBridge"><code class="docutils literal notranslate"><span class="pre">PyTorchFedProxBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.proximal.PyTorchFedProxBridge.do_proximal_sgd"><code class="docutils literal notranslate"><span class="pre">PyTorchFedProxBridge.do_proximal_sgd()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.sgd.PyTorchSGDBridge"><code class="docutils literal notranslate"><span class="pre">PyTorchSGDBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.pytorch.sgd.PyTorchSGDBridge.do_sgd"><code class="docutils literal notranslate"><span class="pre">PyTorchSGDBridge.do_sgd()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.internal.bridge.tensorflow.common">TensorFlow Bridges</a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.common.get_or_make_tf_function"><code class="docutils literal notranslate"><span class="pre">get_or_make_tf_function()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.common.TFCommonBridge"><code class="docutils literal notranslate"><span class="pre">TFCommonBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.common.TFCommonBridge.save_state"><code class="docutils literal notranslate"><span class="pre">TFCommonBridge.save_state()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.common.TFCommonBridge.load_state"><code class="docutils literal notranslate"><span class="pre">TFCommonBridge.load_state()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge"><code class="docutils literal notranslate"><span class="pre">TFFTRLBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.loss_and_gradient"><code class="docutils literal notranslate"><span class="pre">TFFTRLBridge.loss_and_gradient()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.lbfgs_direction"><code class="docutils literal notranslate"><span class="pre">TFFTRLBridge.lbfgs_direction()</span></code></a></li>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.ftrl.TFFTRLBridge.terminate_fn"><code class="docutils literal notranslate"><span class="pre">TFFTRLBridge.terminate_fn()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.proximal.TFFedProxBridge"><code class="docutils literal notranslate"><span class="pre">TFFedProxBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.proximal.TFFedProxBridge.do_proximal_sgd"><code class="docutils literal notranslate"><span class="pre">TFFedProxBridge.do_proximal_sgd()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.sgd.TFSGDBridge"><code class="docutils literal notranslate"><span class="pre">TFSGDBridge</span></code></a><ul>
<li><a class="reference internal" href="#pfl.internal.bridge.tensorflow.sgd.TFSGDBridge.do_sgd"><code class="docutils literal notranslate"><span class="pre">TFSGDBridge.do_sgd()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=4621528c"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>