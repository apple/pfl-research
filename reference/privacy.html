<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="article:modified_time" content="2025-06-16T14:43:29+00:00" /><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Training statistics" href="stats.html" /><link rel="prev" title="Postprocessor" href="postprocessor.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Differential privacy - pfl 0.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pfl 0.3.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">pfl 0.3.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/fl_introduction.html">Federated learning with pfl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/simulation_distributed.html">Fast distributed simulations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate.html">Backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate.html#aggregator">Aggregator</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate.html#module-pfl.aggregate.data_transport">Data transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate.html#module-pfl.aggregate.weighting">Weighting</a></li>
<li class="toctree-l1"><a class="reference internal" href="callback.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="common_types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="exception.html">Exception</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperparam.html">Hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="postprocessor.html">Postprocessor</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Differential privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">Training statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tree.html">Gradient boosted decision trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_variables.html">Environment variables</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="internal/index.html">Internal API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Internal API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="internal/bisect.html">Bisect</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/bridge.html">Bridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/distribution.html">Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/ops.html">Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/platform.html">Platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/privacy_loss_bound.html">Privacy loss bound</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/tree.html">Tree</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="differential-privacy">
<span id="privacy"></span><h1>Differential privacy<a class="headerlink" href="#differential-privacy" title="Link to this heading">#</a></h1>
<section id="module-pfl.privacy.privacy_mechanism">
<span id="abstract-base-classes"></span><h2>Abstract base classes<a class="headerlink" href="#module-pfl.privacy.privacy_mechanism" title="Link to this heading">#</a></h2>
<p>Apply differential privacy to statistics.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.PrivacyMetricName">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">PrivacyMetricName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_local_privacy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_summed_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.PrivacyMetricName" title="Link to this definition">#</a></dt>
<dd><p>A structured name for privacy metrics which includes whether it was
generated using a local privacy mechanism or central privacy mechanism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>description</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The metric name represented as a string.</p></li>
<li><p><strong>is_local_privacy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <cite>True</cite> if metric is related to local DP, <cite>False</cite> means central DP.</p></li>
<li><p><strong>on_summed_stats</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <cite>True</cite> if metric is calculated on summed stats.
Usually only true for the noise operation of central DP.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.PrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">PrivacyMechanism</span></span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.PrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Base class for privacy mechanisms.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.LocalPrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">LocalPrivacyMechanism</span></span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Base class for mechanisms that convert statistics into their
local differentially private version.
This will often perform clipping and then add noise.</p>
<p>Bounds on the privacy loss (for example, epsilon and delta) should be passed
in as parameters when constructing the object.
These are the parameters that would be baked in on device.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.privatize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">privatize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">LocalPrivacyMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.privatize" title="Link to this definition">#</a></dt>
<dd><p>Take unbounded statistics from one individual and turn them directly
into statistics that protect the individual’s privacy using
differential privacy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics to be made differentially private.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(noised_statistics, metrics)</cite>
<cite>noised_statistics</cite> is a new
<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, that is a version of
<cite>statistics</cite> that has been constrained and has had
noise added to it (i.e., it has been privatized).
<cite>metrics</cite> is a <cite>Metrics</cite> object with <cite>name: value</cite> where <cite>value</cite>
can be useful to display or analyse.
For example, this could have statistics on the properties of the
noise added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_one_user">
<span class="sig-name descname"><span class="pre">postprocess_one_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_one_user" title="Link to this definition">#</a></dt>
<dd><p>Do any postprocessing of client’s statistics before it is communicated
back to the server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – Statistics returned from the local training procedure of this user.</p></li>
<li><p><strong>user_context</strong> (<a class="reference internal" href="context.html#pfl.context.UserContext" title="pfl.context.UserContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserContext</span></code></a>) – Additional information about the current user.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(transformed_stats, metrics)</cite>, where <cite>transformed_stats</cite>
is <cite>stats</cite> after it is processed by the postprocessor, and
<cite>metrics</cite> is any new metrics to track. Default implementation
does nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_server">
<span class="sig-name descname"><span class="pre">postprocess_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_server" title="Link to this definition">#</a></dt>
<dd><p>Do any postprocessing of the aggregated statistics object after
central aggregation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The aggregated statistics.</p></li>
<li><p><strong>central_context</strong> (<a class="reference internal" href="context.html#pfl.context.CentralContext" title="pfl.context.CentralContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentralContext</span></code></a>) – Information about aggregation and other useful server-side
properties.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(transformed_stats, metrics)</cite>, where <cite>transformed_stats</cite>
is <cite>stats</cite> after it is processed by the postprocessor, and
<cite>metrics</cite> is any new metrics to track. Default implementation
does nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_server_live">
<span class="sig-name descname"><span class="pre">postprocess_server_live</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_server_live" title="Link to this definition">#</a></dt>
<dd><p>Just like <cite>postprocess_server</cite>, but for live training. Default
implementation is to call <cite>postprocess_server</cite>.
Only override this in certain circumstances when you want different
behaviour for live training, e.g. central DP.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.SplitPrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">SplitPrivacyMechanism</span></span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Base class for privacy mechanism that works in two stages: (1) constrain
the sensitivity; (2) add noise.</p>
<p>This is the case for many mechanisms.
Some of those can be used for central privacy, but not all.
Even where not, they can sometimes be approximated by a central privacy
mechanism.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.constrain_sensitivity">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constrain_sensitivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">SplitPrivacyMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.constrain_sensitivity" title="Link to this definition">#</a></dt>
<dd><p>Constrain the sensitivity of the statistics, e.g. by norm-clipping.
This makes it possible to determine the amount of noise necessary to
guarantee differential privacy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics that need to be constrained.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(constrained_statistics, metrics)</cite>.
<cite>constrained_statistics</cite> is a new <code class="docutils literal notranslate"><span class="pre">TrainingStatistics</span></code>
which is a version <cite>statistics</cite> that adheres to the sensitivity.
<cite>metrics</cite> is a dict <cite>description: value</cite> where <cite>value</cite> is a value
that can be useful to display or analyse.
For example, this could have statistics on the clipping performed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.add_noise">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">SplitPrivacyMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Transform statistics to protect the privacy of the data with
differential privacy, for example by adding noise.
It is assumed that the contribution of any individual user to
<cite>statistics</cite> has been limited using <cite>constrain_sensitivity</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics to be made differentially private.</p></li>
<li><p><strong>cohort_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of individuals whose data has gone into <cite>statistics</cite>.
This is required in particular for approximations of local DP.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(noised_statistics, metrics)</cite>
<cite>noised_statistics</cite> is a new
<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, that
is a clipped/noised version of <cite>clipped_statistics</cite>.
<cite>metrics</cite> is a <cite>Metrics</cite> object with <cite>name: value</cite> where <cite>value</cite>
can be useful to display or analyse.
For example, this could have statistics on the properties of the
noise added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.privatize">
<span class="sig-name descname"><span class="pre">privatize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">SplitPrivacyMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.privatize" title="Link to this definition">#</a></dt>
<dd><p>Take unbounded statistics from one individual and turn them directly
into statistics that protect the individual’s privacy using
differential privacy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics to be made differentially private.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(noised_statistics, metrics)</cite>
<cite>noised_statistics</cite> is a new
<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, that is a version of
<cite>statistics</cite> that has been constrained and has had
noise added to it (i.e., it has been privatized).
<cite>metrics</cite> is a <cite>Metrics</cite> object with <cite>name: value</cite> where <cite>value</cite>
can be useful to display or analyse.
For example, this could have statistics on the properties of the
noise added.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.CentrallyApplicablePrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">CentrallyApplicablePrivacyMechanism</span></span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.CentrallyApplicablePrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Base class for local privacy mechanisms that can be applied centrally
to approximate the local privacy mechanism more efficiently. Classes
representing such mechanisms should derive from this.</p>
<p>To apply the mechanism centrally, <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> will be called
on each contribution, and <code class="docutils literal notranslate"><span class="pre">add_noise</span></code> on the aggregate.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.CentralPrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">CentralPrivacyMechanism</span></span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.CentralPrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Base class for differential privacy mechanisms which provides central
differential privacy.</p>
<p>This means that <code class="docutils literal notranslate"><span class="pre">postprocess_one_user</span></code> may apply processing to ensure
sensitivity, and <code class="docutils literal notranslate"><span class="pre">postprocess_server</span></code> will transform the aggregate
statistics randomly.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">CentrallyAppliedPrivacyMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">underlying_mechanism</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Wrap a local privacy mechanism (which is a local privacy mechanism by
default), and transform it into a central privacy mechanism. The wrapped
mechanism is transformed to perform <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> to
individual contributions and <code class="docutils literal notranslate"><span class="pre">add_noise</span></code> on the aggregated statistics
server-side.</p>
<p>This also means that in the standard case, scaling can happen in
<code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> and be undone in <code class="docutils literal notranslate"><span class="pre">add_noise</span></code>.
For example, <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> can choose to clip to a clipping
bound, or to 1.
In the latter case, <code class="docutils literal notranslate"><span class="pre">add_noise</span></code> should probably scale by the clipping
bound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>underlying_mechanism</strong> (<a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentrallyApplicablePrivacyMechanism" title="pfl.privacy.privacy_mechanism.CentrallyApplicablePrivacyMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentrallyApplicablePrivacyMechanism</span></code></a>) – The privacy mechanism (which is a local privacy mechanism by default)
to transform into a central privacy mechanism.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_one_user">
<span class="sig-name descname"><span class="pre">postprocess_one_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_one_user" title="Link to this definition">#</a></dt>
<dd><p>Do any postprocessing of client’s statistics before it is communicated
back to the server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – Statistics returned from the local training procedure of this user.</p></li>
<li><p><strong>user_context</strong> (<a class="reference internal" href="context.html#pfl.context.UserContext" title="pfl.context.UserContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserContext</span></code></a>) – Additional information about the current user.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(transformed_stats, metrics)</cite>, where <cite>transformed_stats</cite>
is <cite>stats</cite> after it is processed by the postprocessor, and
<cite>metrics</cite> is any new metrics to track. Default implementation
does nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_server">
<span class="sig-name descname"><span class="pre">postprocess_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_server" title="Link to this definition">#</a></dt>
<dd><p>Do any postprocessing of the aggregated statistics object after
central aggregation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The aggregated statistics.</p></li>
<li><p><strong>central_context</strong> (<a class="reference internal" href="context.html#pfl.context.CentralContext" title="pfl.context.CentralContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentralContext</span></code></a>) – Information about aggregation and other useful server-side
properties.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(transformed_stats, metrics)</cite>, where <cite>transformed_stats</cite>
is <cite>stats</cite> after it is processed by the postprocessor, and
<cite>metrics</cite> is any new metrics to track. Default implementation
does nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_server_live">
<span class="sig-name descname"><span class="pre">postprocess_server_live</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_server_live" title="Link to this definition">#</a></dt>
<dd><p>Just like <cite>postprocess_server</cite>, but for live training. Default
implementation is to call <cite>postprocess_server</cite>.
Only override this in certain circumstances when you want different
behaviour for live training, e.g. central DP.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.NormClipping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_mechanism.</span></span><span class="sig-name descname"><span class="pre">NormClipping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clipping_bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.NormClipping" title="Link to this definition">#</a></dt>
<dd><p>Constrain the sensitivity of an individual’s data by clipping the ℓp norm.
This clipping is the first step in many privacy mechanisms.
This class implements one half of
<a class="reference internal" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism" title="pfl.privacy.privacy_mechanism.LocalPrivacyMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalPrivacyMechanism</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The order of the norm.
This must be a positive integer (e.g., <cite>1</cite> or <cite>2</cite>) or np.inf.</p></li>
<li><p><strong>clipping_bound</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="hyperparam.html#pfl.hyperparam.base.HyperParam" title="pfl.hyperparam.base.HyperParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperParam</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The norm bound for clipping.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_mechanism.NormClipping.constrain_sensitivity">
<span class="sig-name descname"><span class="pre">constrain_sensitivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">NormClipping.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_mechanism.NormClipping.constrain_sensitivity" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Statistics with their overall norm bounded by <code class="docutils literal notranslate"><span class="pre">clipping_bound</span></code>.
The norm of these statistics may be less.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="privacy-mechanisms">
<h2>Privacy mechanisms<a class="headerlink" href="#privacy-mechanisms" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.NoPrivacy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.</span></span><span class="sig-name descname"><span class="pre">NoPrivacy</span></span><a class="headerlink" href="#pfl.privacy.NoPrivacy" title="Link to this definition">#</a></dt>
<dd><p>Dummy privacy mechanism that does not do anything, but presents the same
interface as real privacy mechanisms. This is useful for testing
functionality of the code without the impact of a privacy mechanism.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.NoPrivacy.constrain_sensitivity">
<span class="sig-name descname"><span class="pre">constrain_sensitivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">NoPrivacy.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.NoPrivacy.constrain_sensitivity" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <cite>(statistics, metrics)</cite>.
<cite>statistics</cite> is the input unchanged.
<cite>metrics</cite> is empty.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.NoPrivacy.add_noise">
<span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">NoPrivacy.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.NoPrivacy.add_noise" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <cite>(statistics, metrics)</cite>.
<cite>statistics</cite> is the input unchanged.
<cite>metrics</cite> is empty.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.NormClippingOnly">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.</span></span><span class="sig-name descname"><span class="pre">NormClippingOnly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clipping_bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.NormClippingOnly" title="Link to this definition">#</a></dt>
<dd><p>Dummy privacy mechanism that does not do any privacy but only lp-norm
clipping, but presents the same interface as real privacy mechanisms.
This is useful for testing the impact of clipping only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The order of the norm.
This must be a positive integer (e.g., <cite>1</cite> or <cite>2</cite>) or np.inf.</p></li>
<li><p><strong>clipping_bound</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="hyperparam.html#pfl.hyperparam.base.HyperParam" title="pfl.hyperparam.base.HyperParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperParam</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The norm bound for clipping.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-pfl.privacy.laplace_mechanism">The Laplace mechanism for differential privacy.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.laplace_mechanism.LaplaceMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.laplace_mechanism.</span></span><span class="sig-name descname"><span class="pre">LaplaceMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clipping_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism" title="Link to this definition">#</a></dt>
<dd><p>Apply the Laplace mechanism for differential privacy according to Section
3.3 in:
<a class="reference external" href="https://www.cis.upenn.edu/~aaroth/Papers/privacybook.pdf">https://www.cis.upenn.edu/~aaroth/Papers/privacybook.pdf</a></p>
<p>The l1 norm is computed over all the arrays and clipped by a bound
to be able to use Definition 3.1. Thereafter, Laplacian noise,
parameterized according to Definition 3.3, is added to all arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>epsilon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The ε parameter of differential privacy.
This gives an upper bound on the amount of privacy loss.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.laplace_mechanism.LaplaceMechanism.sensitivity_scaling">
<span class="sig-name descname"><span class="pre">sensitivity_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.sensitivity_scaling" title="Link to this definition">#</a></dt>
<dd><p>Return scaling that needs to be applied to the output of
<code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_dimensions</strong> – The number of dimensions of the vector that this mechanism is
applied on.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.laplace_mechanism.LaplaceMechanism.sensitivity_squared_error">
<span class="sig-name descname"><span class="pre">sensitivity_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_norm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.sensitivity_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Return the expected squared error that is caused by random behaviour of
the <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> method.
Note that this does not include error introduced by clipping.
If <code class="docutils literal notranslate"><span class="pre">add_noise</span></code> scales the output of <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code>, that
scaling does not have to be included.
Instead just include it in <code class="docutils literal notranslate"><span class="pre">sensitivity_scaling</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p></li>
<li><p><strong>l2_norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The L2 norm of the vector that this mechanism is applied on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.laplace_mechanism.LaplaceMechanism.add_noise_squared_error">
<span class="sig-name descname"><span class="pre">add_noise_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.add_noise_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Return the expected squared error that is caused by the <code class="docutils literal notranslate"><span class="pre">add_noise</span></code>
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p></li>
<li><p><strong>l2_norm</strong> – The L2 norm of the vector that this mechanism is applied on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.laplace_mechanism.LaplaceMechanism.add_noise">
<span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">LaplaceMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Transform statistics to protect the privacy of the data with
differential privacy, for example by adding noise.
It is assumed that the contribution of any individual user to
<cite>statistics</cite> has been limited using <cite>constrain_sensitivity</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics to be made differentially private.</p></li>
<li><p><strong>cohort_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of individuals whose data has gone into <cite>statistics</cite>.
This is required in particular for approximations of local DP.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(noised_statistics, metrics)</cite>
<cite>noised_statistics</cite> is a new
<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, that
is a clipped/noised version of <cite>clipped_statistics</cite>.
<cite>metrics</cite> is a <cite>Metrics</cite> object with <cite>name: value</cite> where <cite>value</cite>
can be useful to display or analyse.
For example, this could have statistics on the properties of the
noise added.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-pfl.privacy.gaussian_mechanism">The Gaussian mechanism for differential privacy.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.gaussian_mechanism.GaussianMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.gaussian_mechanism.</span></span><span class="sig-name descname"><span class="pre">GaussianMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clipping_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_noise_stddev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism" title="Link to this definition">#</a></dt>
<dd><p>Apply the Gaussian mechanism for differential privacy, which consists
of scaling the statistics down to make their ℓ² norm smaller or equal
than the clipping bound parameter, and adding Gaussian noise.</p>
<p>The ℓ² norm is computed over all the arrays in <cite>statistics</cite> (as if these
were concatenated into a single vector). If the norm is greater than the
clipping bound, the statistics are scaled down linearly so that the
resulting ℓ² norm is equal to the bound.
If the ℓ² norm is below the bound, the original values are passed through
unaltered.</p>
<p>The Gaussian noise is then added to each statistic with the scale defined
by the relative_noise_stddev as described below.</p>
<p>To ensure (epsilon, delta) differential privacy, it is important to ensure
that relative_noise_stddev is sufficiently large.  To initialize this class
using <cite>epsilon</cite> and <cite>delta</cite>, rather than using the standard deviation of the
Gaussian noise, use the method <cite>construct_single_iteration</cite> (this sets the
noise standard deviation automatically to ensure (epsilon, delta) DP).</p>
<p>The differential privacy guarantee assumes that each user participates
in the training at most once. For multiple iterations (which is the
typical case in Federated Learning), it is recommended to use
<code class="docutils literal notranslate"><span class="pre">from_privacy_accountant</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clipping_bound</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="hyperparam.html#pfl.hyperparam.base.HyperParam" title="pfl.hyperparam.base.HyperParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperParam</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The ℓ² norm bound for clipping the statistics (e.g. model updates) using
<code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> before sending them back to the server.</p></li>
<li><p><strong>relative_noise_stddev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The standard deviation of the Gaussian noise added to each statistic is
defined as <code class="docutils literal notranslate"><span class="pre">relative_noise_stddev</span> <span class="pre">*</span> <span class="pre">clipping_bound</span></code>. The standard deviation
thus increases linearly with the clipping bound and the multiplier is
given by this parameter <code class="docutils literal notranslate"><span class="pre">relative_noise_stddev</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.gaussian_mechanism.GaussianMechanism.sensitivity_scaling">
<span class="sig-name descname"><span class="pre">sensitivity_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.sensitivity_scaling" title="Link to this definition">#</a></dt>
<dd><p>Return scaling that needs to be applied to the output of
<code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_dimensions</strong> – The number of dimensions of the vector that this mechanism is
applied on.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.gaussian_mechanism.GaussianMechanism.sensitivity_squared_error">
<span class="sig-name descname"><span class="pre">sensitivity_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_norm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.sensitivity_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Return the expected squared error that is caused by random behaviour of
the <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> method.
Note that this does not include error introduced by clipping.
If <code class="docutils literal notranslate"><span class="pre">add_noise</span></code> scales the output of <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code>, that
scaling does not have to be included.
Instead just include it in <code class="docutils literal notranslate"><span class="pre">sensitivity_scaling</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p></li>
<li><p><strong>l2_norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The L2 norm of the vector that this mechanism is applied on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.gaussian_mechanism.GaussianMechanism.add_noise_squared_error">
<span class="sig-name descname"><span class="pre">add_noise_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.add_noise_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Return the expected squared error that is caused by the <code class="docutils literal notranslate"><span class="pre">add_noise</span></code>
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p></li>
<li><p><strong>l2_norm</strong> – The L2 norm of the vector that this mechanism is applied on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.gaussian_mechanism.GaussianMechanism.add_noise">
<span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">GaussianMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Transform statistics to protect the privacy of the data with
differential privacy, for example by adding noise.
It is assumed that the contribution of any individual user to
<cite>statistics</cite> has been limited using <cite>constrain_sensitivity</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics to be made differentially private.</p></li>
<li><p><strong>cohort_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of individuals whose data has gone into <cite>statistics</cite>.
This is required in particular for approximations of local DP.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(noised_statistics, metrics)</cite>
<cite>noised_statistics</cite> is a new
<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, that
is a clipped/noised version of <cite>clipped_statistics</cite>.
<cite>metrics</cite> is a <cite>Metrics</cite> object with <cite>name: value</cite> where <cite>value</cite>
can be useful to display or analyse.
For example, this could have statistics on the properties of the
noise added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.gaussian_mechanism.GaussianMechanism.construct_single_iteration">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">construct_single_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clipping_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.construct_single_iteration" title="Link to this definition">#</a></dt>
<dd><p>Construct an instance of <cite>GaussianMechanism</cite> from an ε and a δ.
This is suitable for giving out data once.
If you apply the noise to the same individual’s data multiple times, the
privacy costs should be added up.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clipping_bound</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="hyperparam.html#pfl.hyperparam.base.HyperParam" title="pfl.hyperparam.base.HyperParam"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperParam</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The norm bound for clipping.</p></li>
<li><p><strong>epsilon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The ε parameter of differential privacy.
This gives an upper bound on the amount of privacy loss.</p></li>
<li><p><strong>delta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The δ (delta) parameter of (ε,δ)-differential privacy.
This gives an upper bound on the probability that the privacy loss
is more than ε.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism" title="pfl.privacy.gaussian_mechanism.GaussianMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianMechanism</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.gaussian_mechanism.GaussianMechanism.from_privacy_accountant">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_privacy_accountant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accountant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clipping_bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.from_privacy_accountant" title="Link to this definition">#</a></dt>
<dd><p>Construct an instance of <cite>GaussianMechanism</cite> from an instance of
<cite>PrivacyAccountant</cite>.</p>
</dd></dl>

</dd></dl>

<p id="module-pfl.privacy.ftrl_mechanism">Banded matrix factorization mechanism based on primal optimization algorithms.
Reference: <a class="reference external" href="https://github.com/google-research/federated/blob/master/multi_epoch_dp_matrix_factorization/multiple_participations/primal_optimization.py">https://github.com/google-research/federated/blob/master/multi_epoch_dp_matrix_factorization/multiple_participations/primal_optimization.py</a>.  # pylint: disable=line-too-long</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.ftrl_mechanism.FTRLMatrixFactorizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.ftrl_mechanism.</span></span><span class="sig-name descname"><span class="pre">FTRLMatrixFactorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workload_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.ftrl_mechanism.FTRLMatrixFactorizer" title="Link to this definition">#</a></dt>
<dd><p>Class for factorizing matrices for matrix mechanism based on solving the
optimization problem in Equation 6 in <a class="reference external" href="https://arxiv.org/pdf/2306.08153.pdf">https://arxiv.org/pdf/2306.08153.pdf</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workload_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – The input workload, n x n lower triangular matrix.</p></li>
<li><p><strong>mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – A boolean matrix describing the constraints on the gram matrix
X = C^T C.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.ftrl_mechanism.FTRLMatrixFactorizer.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.ftrl_mechanism.FTRLMatrixFactorizer.optimize" title="Link to this definition">#</a></dt>
<dd><p>Optimize the strategy matrix with an iterative gradient-based method.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.ftrl_mechanism.ForwardSubstitution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.ftrl_mechanism.</span></span><span class="sig-name descname"><span class="pre">ForwardSubstitution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.ftrl_mechanism.ForwardSubstitution" title="Link to this definition">#</a></dt>
<dd><p>Solve for X in LX = Y in an online manner using forward substitution where
L is a lower-triangular matrix, as in Algorithm 9 in
<a class="reference external" href="https://arxiv.org/pdf/2306.08153.pdf">https://arxiv.org/pdf/2306.08153.pdf</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – The lower triangular matrix L.</p></li>
<li><p><strong>bandwidth</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Optional bandwidth of L.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.ftrl_mechanism.ForwardSubstitution.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.ftrl_mechanism.ForwardSubstitution.step" title="Link to this definition">#</a></dt>
<dd><p>At step i, $X_i = (Y_i - sum_{j=1}^{i-1} L_{i,j} X_j) / L_{i,i}$</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.ftrl_mechanism.BandedMatrixFactorizationMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.ftrl_mechanism.</span></span><span class="sig-name descname"><span class="pre">BandedMatrixFactorizationMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clipping_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_separation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_privacy_accountant</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.ftrl_mechanism.BandedMatrixFactorizationMechanism" title="Link to this definition">#</a></dt>
<dd><p>Banded matrix factorization mechanism <a class="reference external" href="https://arxiv.org/pdf/2306.08153.pdf">https://arxiv.org/pdf/2306.08153.pdf</a>.
Matrix Mechanism in PFL privately estimates $AX = B(CX + Z)$, where
$X in R^{Ttimes d} = [x_1, x_2, cdots x_T]$ is the series of aggregated
gradients at each PFL iteration. $A$ is the workload matrix which is set
to the lower triangular matrix with all ones. $Z$ is the Gaussian noise
added. $BC = A$  is a factorization of $A$ such that the noise added is
minimized.</p>
<p>In the banded matrix setting, $C$ is a lower triangular banded matrix and
the mechanism can be written as $A(X + C^{-1}Z)$, where in each step, a
correlated noise from previous steps is added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clipping_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The norm bound for clipping.</p></li>
<li><p><strong>num_iterations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of times the mechanism will be applied.</p></li>
<li><p><strong>min_separation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Minimum number of iteration gap between two participation of a single
device.</p></li>
<li><p><strong>make_privacy_accountant</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <a class="reference internal" href="#pfl.privacy.PrivacyAccountant" title="pfl.privacy.privacy_accountant.PrivacyAccountant"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrivacyAccountant</span></code></a>]) – Lambda function that takes number of compositions as input and returns
privacy accountant, of type PrivacyAccountantKind.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>::example</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">make_privacy_accountant</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">num_compositions</span><span class="p">:</span>
    <span class="n">PLDPrivacyAccountant</span><span class="p">(</span><span class="n">num_compositions</span><span class="p">,</span> <span class="o">**</span><span class="n">other_params</span><span class="p">)</span>
<span class="n">BandedMatrixFactorizationMechanism</span><span class="p">(</span><span class="n">clipping_bound</span><span class="p">,</span> <span class="n">num_iterations</span><span class="p">,</span>
    <span class="n">min_separation</span><span class="p">,</span> <span class="n">make_privacy_accountant</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.ftrl_mechanism.BandedMatrixFactorizationMechanism.add_noise">
<span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">BandedMatrixFactorizationMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.ftrl_mechanism.BandedMatrixFactorizationMechanism.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Transform statistics to protect the privacy of the data with
differential privacy, for example by adding noise.
It is assumed that the contribution of any individual user to
<cite>statistics</cite> has been limited using <cite>constrain_sensitivity</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics to be made differentially private.</p></li>
<li><p><strong>cohort_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of individuals whose data has gone into <cite>statistics</cite>.
This is required in particular for approximations of local DP.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(noised_statistics, metrics)</cite>
<cite>noised_statistics</cite> is a new
<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, that
is a clipped/noised version of <cite>clipped_statistics</cite>.
<cite>metrics</cite> is a <cite>Metrics</cite> object with <cite>name: value</cite> where <cite>value</cite>
can be useful to display or analyse.
For example, this could have statistics on the properties of the
noise added.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-pfl.privacy.joint_mechanism">Joint mechanism for combining multiple mechanisms into one.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.joint_mechanism.JointMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.joint_mechanism.</span></span><span class="sig-name descname"><span class="pre">JointMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mechanisms_and_keys</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.joint_mechanism.JointMechanism" title="Link to this definition">#</a></dt>
<dd><p>Constructs a new CentrallyApplicablePrivacyMechanism from existing ones.
Each existing mechanism is applied to a disjoint subset of the client
statistics keys. As such JointMechanism can only be applied to client
statistics of type MappedVectorStatistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mechanisms_and_keys</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentrallyApplicablePrivacyMechanism" title="pfl.privacy.privacy_mechanism.CentrallyApplicablePrivacyMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentrallyApplicablePrivacyMechanism</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]]) – <p>Dictionary which maps a name of a mechanism to a tuple consisting of
the corresponding CentrallyApplicablePrivacyMechanism and a list specifying
which keys of the user training statistics that mechanism should be applied
to. This list can contain strings of the following forms:</p>
<ul class="simple">
<li><p>key_name - an exact key name as appearing in the user statistics,</p></li>
<li><p>f’{key_prefix}/’ - matches to all user statistics keys of the form</p></li>
</ul>
<p>f’{key_prefix}/{any_string}’.</p>
<p>Finally, note that the names of each of the mechanisms must be distinct
for the purpose of naming the corresponding Metrics.</p>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.joint_mechanism.JointMechanism.constrain_sensitivity">
<span class="sig-name descname"><span class="pre">constrain_sensitivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">JointMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.joint_mechanism.JointMechanism.constrain_sensitivity" title="Link to this definition">#</a></dt>
<dd><p>Constrain the sensitivity of the statistics, e.g. by norm-clipping.
This makes it possible to determine the amount of noise necessary to
guarantee differential privacy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics that need to be constrained.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(constrained_statistics, metrics)</cite>.
<cite>constrained_statistics</cite> is a new <code class="docutils literal notranslate"><span class="pre">TrainingStatistics</span></code>
which is a version <cite>statistics</cite> that adheres to the sensitivity.
<cite>metrics</cite> is a dict <cite>description: value</cite> where <cite>value</cite> is a value
that can be useful to display or analyse.
For example, this could have statistics on the clipping performed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.joint_mechanism.JointMechanism.add_noise">
<span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statistics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_formatting_fn=&lt;function</span> <span class="pre">JointMechanism.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.joint_mechanism.JointMechanism.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Transform statistics to protect the privacy of the data with
differential privacy, for example by adding noise.
It is assumed that the contribution of any individual user to
<cite>statistics</cite> has been limited using <cite>constrain_sensitivity</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statistics</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The statistics to be made differentially private.</p></li>
<li><p><strong>cohort_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of individuals whose data has gone into <cite>statistics</cite>.
This is required in particular for approximations of local DP.</p></li>
<li><p><strong>name_formatting_fn</strong> – Function that formats a metric name appropriately.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – An int representing a seed to use for random noise operations.
This is useful to avoid generating the same noise if there are
replicated workers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(noised_statistics, metrics)</cite>
<cite>noised_statistics</cite> is a new
<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, that
is a clipped/noised version of <cite>clipped_statistics</cite>.
<cite>metrics</cite> is a <cite>Metrics</cite> object with <cite>name: value</cite> where <cite>value</cite>
can be useful to display or analyse.
For example, this could have statistics on the properties of the
noise added.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="privacy-accountants">
<h2>Privacy accountants<a class="headerlink" href="#privacy-accountants" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.PrivacyAccountant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.</span></span><span class="sig-name descname"><span class="pre">PrivacyAccountant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_compositions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.PrivacyAccountant" title="Link to this definition">#</a></dt>
<dd><p>Tracks the privacy loss over multiple composition steps.
Either two or three of the variables epsilon, delta and noise_parameter
must be defined. If two are defined, the remaining variable can be
computed. If all three are defined a check will be performed to make sure
a valid set of variable values has been provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_compositions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Maximum number of compositions to be performed with mechanism.</p></li>
<li><p><strong>sampling_probability</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Maximum probability of sampling each entity being privatized. E.g. if
the unit of privacy is one device, this is the probability of each
device participating.</p></li>
<li><p><strong>mechanism</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The noise mechanism used. E.g. Gaussian, Laplace.</p></li>
<li><p><strong>epsilon</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The privacy loss random variable. It controls how much the output of
the mechanism can vary between two neighboring databases.</p></li>
<li><p><strong>delta</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The probability that all privacy will be lost.</p></li>
<li><p><strong>noise_parameter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A parameter for DP noise. For the Gaussian mechanism, the noise
parameter is the standard deviation of the noise. For the Laplace
mechanism, the noise parameter is the scale of the noise.</p></li>
<li><p><strong>noise_scale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – A value in [0, 1] multiplied with the standard deviation of the noise
to be added for privatization. Typically used to experiment with lower
sampling probabilities when it is not possible or desirable to increase
the population size of the units being privatized, e.g. user devices.</p></li>
<li><p><strong>min_bound_noise_parameter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Used to manually set the lower bound of the binary search
used to find the correct noise parameter</p></li>
<li><p><strong>max_bound_noise_parameter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Used to manually set the upper bound of the binary search
used to find the correct noise parameter</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pfl.privacy.PrivacyAccountant.cohort_noise_parameter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cohort_noise_parameter</span></span><a class="headerlink" href="#pfl.privacy.PrivacyAccountant.cohort_noise_parameter" title="Link to this definition">#</a></dt>
<dd><p>Noise parameter to be used on a cohort of users.
Noise scale is considered.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.PLDPrivacyAccountant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.</span></span><span class="sig-name descname"><span class="pre">PLDPrivacyAccountant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_compositions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_discretization_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_connect_dots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pessimistic_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mass_truncation_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.PLDPrivacyAccountant" title="Link to this definition">#</a></dt>
<dd><p>Privacy Loss Distribution (PLD) privacy accountant, from dp-accounting
package.</p>
<p>The PLD algorithm is based on: “Tight on budget?: Tight bounds for r-fold
approximate differential privacy.”, Meiser and Mohammadi, in CCS, pages
247-264, 2018, <a class="reference external" href="https://eprint.iacr.org/2017/1034.pdf">https://eprint.iacr.org/2017/1034.pdf</a>
The Connect-the-Docts algorithm is based on: “Connect the Dots: Tighter
Discrete Approximations of Privacy Loss Distributions”, Doroshenko et al.,
PoPETs 2022, <a class="reference external" href="https://arxiv.org/pdf/2207.04380.pdf">https://arxiv.org/pdf/2207.04380.pdf</a>
This class supports Gaussian and Laplacian mechanisms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_discretization_interval</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The length of the dicretization interval for the privacy loss
distribution. Rounding will occur to integer multiples of
value_discretization_interval. Smaller values yield more accurate
estimates of the privacy loss, while incurring higher compute and
memory. Hence, larger values decrease computation time. Note that the
accountant algorithm maintains similar error bounds as the value of
value_discretization_interval is changed.</p></li>
<li><p><strong>use_connect_dots</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – boolean indicating whether or not to use Connect-the-Dots algorithm by
Doroshenko et al., which gives tighter discrete approximations of PLDs.</p></li>
<li><p><strong>pessimistic_estimate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – boolean indicating whether rounding used in PLD algorithm results in
epsilon-hockey stick divergence computation yielding upper estimate to
real value.</p></li>
<li><p><strong>log_mass_truncation_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The natural log of probability mass that may be discarded from noise
distribution.
Larger values will increase the error.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.PRVPrivacyAccountant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.</span></span><span class="sig-name descname"><span class="pre">PRVPrivacyAccountant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_compositions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.PRVPrivacyAccountant" title="Link to this definition">#</a></dt>
<dd><p>Privacy Random Variable (PRV) accountant, for heterogeneous composition,
using prv-accountant package.
prv-accountant package: <a class="reference external" href="https://pypi.org/project/prv-accountant/">https://pypi.org/project/prv-accountant/</a>
Based on: “Numerical Composition of Differential Privacy”, Gopi et al.,
2021, <a class="reference external" href="https://arxiv.org/pdf/2106.02848.pdf">https://arxiv.org/pdf/2106.02848.pdf</a>
The PRV accountant methods compute_delta() and compute_epsilon() return
a lower bound, an estimated value, and an upper bound for the delta and
epsilon respectively. The estimated value is used for all further
computations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps_error</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Maximum permitted error in epsilon. Typically around 0.1.</p></li>
<li><p><strong>delta_error</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Maximum error allowed in delta. Typically around delta * 1e-3</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.RDPPrivacyAccountant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.</span></span><span class="sig-name descname"><span class="pre">RDPPrivacyAccountant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_compositions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bound_noise_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.RDPPrivacyAccountant" title="Link to this definition">#</a></dt>
<dd><p>Privacy accountant using Renyi differential privacy (RDP) from
dp-accounting package.
Implementation in dp-accounting: <a class="reference external" href="https://github.com/google/differential-privacy/blob/main/python/dp_accounting/rdp/rdp_privacy_accountant.py">https://github.com/google/differential-privacy/blob/main/python/dp_accounting/rdp/rdp_privacy_accountant.py</a> # pylint: disable=line-too-long
The default neighbouring relation for the RDP account is “add or remove
one”. The default RDP orders used are:
([1 + x / 10. for x in range(1, 100)] + list(range(11, 64)) +
[128, 256, 512, 1024]).</p>
</dd></dl>

</section>
<section id="joint-privacy-accountants">
<h2>Joint Privacy accountants<a class="headerlink" href="#joint-privacy-accountants" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.JointPrivacyAccountant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.</span></span><span class="sig-name descname"><span class="pre">JointPrivacyAccountant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mechanisms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accountants</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_compositions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism_epsilons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism_deltas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget_proportions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pld_accountant_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prv_accountant_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.JointPrivacyAccountant" title="Link to this definition">#</a></dt>
<dd><p>Tracks the privacy loss over multiple mechanisms simultaneously.</p>
<p>This class can be used in a number of different ways.</p>
<p>1. An overall budget (total_epsilon, total_delta) is known, and we wish to
find the corresponding noise parameters of each of the mechanisms so that
the composition of all mechanisms adheres to the overall budget.
The budget_proportions parameter specifies what fraction of the total budget
each mechanism is allocated. For budget_proportions = [p_1, p_2, …] the
noise parameters are then computed as follows. When the accountant class
is the same for each mechanism we find naive_epsilon &gt; total_epsilon and
noise parameters [sigma_1, sigma_2, …] such that the following two
constraints hold:</p>
<blockquote>
<div><p>A. For each i, mechanism_i with noise parameter sigma_i is
(naive_epsilon * p_i, total_delta * p_i) DP after all composition steps,
B. The composition of all mechanisms over all steps is
(total_epsilon, total_delta) DP.</p>
</div></blockquote>
<p>When the accountant classes to be used for each mechanism are different we
can only use basic composition and the noise parameter for each mechanism is computed
separately so that mechanism_i is (total_epsilon * p_i, total_delta * p_i) DP.</p>
<p>2. The individual mechanism privacy budgets are known, i.e. mechanism_epsilons and
mechanism_deltas are given. In this case we can compute the required noise parameter
of each mechanism. The overall budget is then computed as described in 3.</p>
<p>3. The mechanism noise parameters are known, either because they have been computed
in 2. or because they have been given directly. In this case we compute the overall
privacy budget (total_epsilon, total_delta) by efficient composition if possible
(i.e. when using the same privacy accountant class) and by basic composition if not
possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mechanisms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – The list of noise mechanisms to be used, each can be either Gaussian or Laplace.</p></li>
<li><p><strong>accountants</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#pfl.privacy.PLDPrivacyAccountant" title="pfl.privacy.privacy_accountant.PLDPrivacyAccountant"><code class="xref py py-class docutils literal notranslate"><span class="pre">PLDPrivacyAccountant</span></code></a> | <a class="reference internal" href="#pfl.privacy.PRVPrivacyAccountant" title="pfl.privacy.privacy_accountant.PRVPrivacyAccountant"><code class="xref py py-class docutils literal notranslate"><span class="pre">PRVPrivacyAccountant</span></code></a> | <a class="reference internal" href="#pfl.privacy.RDPPrivacyAccountant" title="pfl.privacy.privacy_accountant.RDPPrivacyAccountant"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDPPrivacyAccountant</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<a class="reference internal" href="#pfl.privacy.PLDPrivacyAccountant" title="pfl.privacy.privacy_accountant.PLDPrivacyAccountant"><code class="xref py py-class docutils literal notranslate"><span class="pre">PLDPrivacyAccountant</span></code></a> | <a class="reference internal" href="#pfl.privacy.PRVPrivacyAccountant" title="pfl.privacy.privacy_accountant.PRVPrivacyAccountant"><code class="xref py py-class docutils literal notranslate"><span class="pre">PRVPrivacyAccountant</span></code></a> | <a class="reference internal" href="#pfl.privacy.RDPPrivacyAccountant" title="pfl.privacy.privacy_accountant.RDPPrivacyAccountant"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDPPrivacyAccountant</span></code></a>]]]) – An accountant class, or list of accountant classes, specifying the type of
accountant being used for each of the mechanisms. Must be one of
PLDPrivacyAccountant, PRVPrivacyAccountant or RDPPrivacyAccountant.</p></li>
<li><p><strong>num_compositions</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – A positive integer, or list of positive integers, specifying the maximum
number of compositions to be performed with each mechanism.</p></li>
<li><p><strong>sampling_probability</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – A probability, or list of probabilities, specifying the sampling rate
of each mechanism.</p></li>
<li><p><strong>total_epsilon</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The total epsilon allowed for the composition of all the mechanisms.</p></li>
<li><p><strong>total_delta</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The total delta allowed for the composition of all the mechanisms.</p></li>
<li><p><strong>mechanism_epsilons</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The list of individual epsilons allowed for each mechanism.</p></li>
<li><p><strong>mechanism_deltas</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The list of individual deltas allowed for each mechanism.</p></li>
<li><p><strong>budget_proportions</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – List specifying the proportion of the overall (total_epsilon, total_delta) privacy budget
each mechanism is allocated. Defaults to [1 / len(mechanisms)] * len(mechanisms) if not set,
i.e. even split of the overall budget.</p></li>
<li><p><strong>noise_parameters</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The parameters for DP noise for each mechanism. For the Gaussian
mechanism, the noise parameter is the standard deviation of the noise.
For the Laplace mechanism, the noise parameter is the scale of the noise.</p></li>
<li><p><strong>noise_scale</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – A value in [0, 1] multiplied with the standard deviation of the noise
to be added for privatization. Typically used to experiment with lower
sampling probabilities when it is not possible or desirable to increase
the population size of the units being privatized, e.g. user devices.</p></li>
<li><p><strong>pld_accountant_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>]) – Optional key word arguments that are fed into the PLDPrivacyAccountant
constructor to change the default parameters, see privacy_accountant.py</p></li>
<li><p><strong>prv_accountant_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>]) – Optional key word arguments that are fed into the PRVPrivacyAccountant
constructor to change the default parameters, see privacy_accountant.py</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.JointPrivacyAccountant.compute_for_each_mechanism">
<span class="sig-name descname"><span class="pre">compute_for_each_mechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mechanism_epsilons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mechanism_deltas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.JointPrivacyAccountant.compute_for_each_mechanism" title="Link to this definition">#</a></dt>
<dd><p>Compute for each mechanism independently using the corresponding accountant.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pfl.privacy.JointPrivacyAccountant.cohort_noise_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cohort_noise_parameters</span></span><a class="headerlink" href="#pfl.privacy.JointPrivacyAccountant.cohort_noise_parameters" title="Link to this definition">#</a></dt>
<dd><p>Noise parameters to be used on a cohort of users.
Noise scale is considered.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.JointPrivacyAccountant.check_valid_parameter_settings">
<span class="sig-name descname"><span class="pre">check_valid_parameter_settings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.JointPrivacyAccountant.check_valid_parameter_settings" title="Link to this definition">#</a></dt>
<dd><p>Check that all input parameter settings are valid</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pfl.privacy.adaptive_clipping">
<span id="dp-with-adaptive-clipping"></span><h2>DP with adaptive clipping<a class="headerlink" href="#module-pfl.privacy.adaptive_clipping" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.adaptive_clipping.MutableClippingBound">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.adaptive_clipping.</span></span><span class="sig-name descname"><span class="pre">MutableClippingBound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_clipping_bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.adaptive_clipping.MutableClippingBound" title="Link to this definition">#</a></dt>
<dd><p>A mutable hyperparameter for clipping bound used in adaptive clipping.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.adaptive_clipping.MutableClippingBound.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.adaptive_clipping.MutableClippingBound.value" title="Link to this definition">#</a></dt>
<dd><p>The current state (inner value) of the hyperparameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.adaptive_clipping.</span></span><span class="sig-name descname"><span class="pre">AdaptiveClippingGaussianMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">make_gaussian_mechanism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_clipping_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clipping_indicator_noise_stddev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_clipping_norm_quantile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_space_step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism" title="Link to this definition">#</a></dt>
<dd><p>A <cite>CentrallyAppliedPrivacyMechanism</cite> class to implement adaptive clipping
algorithm as in the paper: <a class="reference external" href="https://arxiv.org/pdf/1905.03871.pdf">https://arxiv.org/pdf/1905.03871.pdf</a>.</p>
<p>The algorithm automatically adjust the clipping bound by optimizing
P(‖x‖₂ ≤ C) = 𝛾, where ‖x‖₂ is the model update ℓ² norm, C is the clipping
bound and 𝛾 is the <cite>adaptive_clipping_norm_quantile</cite>. For example, setting
𝛾=0.1 and the algorithm will iteratively update the clipping bound C such
that 10% of the device model update ℓ² norm will be less than C. Since
the norms of model updates typically vary through the run (oftentimes
decreasing over time), reducing the clipping and consequently also noise
can be beneficial.</p>
<p>The algorithm requires collecting clipping indicator (i.e. whether the model
update is clipped or not) for estimating the quantile that clipping bound C
tracks to optimize C to the desired quantile 𝛾. Clipping indicator is
encoded as -1 or 1 on device and thus the estimated quantile equals averaged
clipping indicators / 2 + 0.5. Central DP noise (standard deviation set by
<cite>clipping_indicator_noise_stddev</cite>) is added to the aggregated clipping
indicator to protect the privacy. Noisy aggregated clipping indicator will
then be used to update clipping bound using geometric update rule with step
size η, i.e. the <cite>log_space_step_size</cite> argument.</p>
<dl>
<dt>:param make_gaussian_mechanism</dt><dd><p>A function that makes a Gaussian Mechanism given a clipping bound as
input. For example:</p>
<dl class="field-list">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pfl.privacy.gaussian_mechanism</span> <span class="kn">import</span> <span class="n">GaussianMechanism</span>
<span class="n">make_gaussian_mechanism</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">GaussianMechanism</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_clipping_bound</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The initial ℓ² clipping bound for Gaussian Mechanism.</p></li>
<li><p><strong>clipping_indicator_noise_stddev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Standard deviation of Gaussian noise added to the aggregated clipping
indicator. Recommended value is <cite>0.1 * cohort_size</cite> as suggested in
<a class="reference external" href="https://arxiv.org/pdf/1905.03871.pdf">https://arxiv.org/pdf/1905.03871.pdf</a>.</p></li>
<li><p><strong>adaptive_clipping_norm_quantile</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – A quantile in [0, 1] representing the desired fraction of device model
updates with ℓ² norm less than the clipping bound.</p></li>
<li><p><strong>log_space_step_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Step size η for optimizing clipping bound in the log space. Clipping
bound C is updated with logC ⟵ log(C exp(-ηg)) = logC - ηg where g is
the derivative of quantile estimation loss. Recommended value for the
step size η is 0.2 (default value) as suggested in
<a class="reference external" href="https://arxiv.org/pdf/1905.03871.pdf">https://arxiv.org/pdf/1905.03871.pdf</a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_one_user">
<span class="sig-name descname"><span class="pre">postprocess_one_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_one_user" title="Link to this definition">#</a></dt>
<dd><p>Postprocess the user local statistics by appending clipping indicator.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_server">
<span class="sig-name descname"><span class="pre">postprocess_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_server" title="Link to this definition">#</a></dt>
<dd><p>Postprocess the aggregated statistics by adding Gaussian noise, popping
clipping indicator and updating central clipping bound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – Aggregated model updates with clipping indicator appended.</p></li>
<li><p><strong>central_context</strong> (<a class="reference internal" href="context.html#pfl.context.CentralContext" title="pfl.context.CentralContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentralContext</span></code></a>) – CentralContext with clipping bound to be updated.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(popped_statistics, metrics)</cite>:
<cite>popped_statistics</cite> is the input model update with clipping
indicator popped.
<cite>metrics</cite> is a dict <cite>description: value</cite> where <cite>value</cite>
contains the noisy norm quantile aggregated from devices and the
updated norm bound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_server_live">
<span class="sig-name descname"><span class="pre">postprocess_server_live</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_server_live" title="Link to this definition">#</a></dt>
<dd><p>Postprocess the aggregated statistics by popping clipping indicator and
updating central clipping bound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – Aggregated model updates with clipping indicator appended.</p></li>
<li><p><strong>central_context</strong> (<a class="reference internal" href="context.html#pfl.context.CentralContext" title="pfl.context.CentralContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentralContext</span></code></a>) – CentralContext with clipping bound to be updated.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(popped_statistics, metrics)</cite>:
<cite>popped_statistics</cite> is the input model update with clipping
indicator popped.
<cite>metrics</cite> is a dict <cite>description: value</cite> where <cite>value</cite>
contain the noisy norm quantile aggregated from devices and the
updated norm bound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.construct_from_privacy_accountant">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">construct_from_privacy_accountant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accountant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_clipping_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clipping_indicator_noise_stddev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_clipping_norm_quantile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_space_step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.construct_from_privacy_accountant" title="Link to this definition">#</a></dt>
<dd><p>Construct an instance of <cite>AdaptiveClippingGaussianMechanism</cite> from a
privacy accountant.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism" title="pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptiveClippingGaussianMechanism</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pfl.privacy.approximate_mechanism">
<span id="approximate-local-dp-with-central-dp"></span><h2>Approximate local DP with central DP<a class="headerlink" href="#module-pfl.privacy.approximate_mechanism" title="Link to this heading">#</a></h2>
<p>Approximate local privacy mechanisms with a central implementation for speed.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.approximate_mechanism.</span></span><span class="sig-name descname"><span class="pre">SquaredErrorLocalPrivacyMechanism</span></span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Abstract base class for a local privacy mechanism that knows its squared
error.
This can be used in two ways.</p>
<p>First, one can use this information to analyse mechanisms.</p>
<p>Second, the local mechanism can be approximated with a central mechanism
with the same squared error.
This central mechanism adds Gaussian noise to the sum of individual
statistics, which is much faster in simulation. However, in live training,
the local privacy mechanism should be applied on each device prior to
sending the data back to the server for aggregation.
Even if the distribution of the error on one individual contribution is not
Gaussian, because of the central limit theorem on a reasonably-sized cohort
the difference will usually not be noticeable.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.sensitivity_scaling">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sensitivity_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.sensitivity_scaling" title="Link to this definition">#</a></dt>
<dd><p>Return scaling that needs to be applied to the output of
<code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.sensitivity_squared_error">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sensitivity_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_norm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.sensitivity_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Return the expected squared error that is caused by random behaviour of
the <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code> method.
Note that this does not include error introduced by clipping.
If <code class="docutils literal notranslate"><span class="pre">add_noise</span></code> scales the output of <code class="docutils literal notranslate"><span class="pre">constrain_sensitivity</span></code>, that
scaling does not have to be included.
Instead just include it in <code class="docutils literal notranslate"><span class="pre">sensitivity_scaling</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p></li>
<li><p><strong>l2_norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The L2 norm of the vector that this mechanism is applied on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.add_noise_squared_error">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_noise_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.add_noise_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Return the expected squared error that is caused by the <code class="docutils literal notranslate"><span class="pre">add_noise</span></code>
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p></li>
<li><p><strong>l2_norm</strong> – The L2 norm of the vector that this mechanism is applied on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.get_squared_error">
<span class="sig-name descname"><span class="pre">get_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cohort_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.get_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Compute the expected squared error from applying this mechanism.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of dimensions of the vector that this mechanism is
applied on.</p></li>
<li><p><strong>l2_norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The L2 norm of the vector that this mechanism is applied on.</p></li>
<li><p><strong>cohort_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of elements in the sum that this mechanism will be
applied on.
Set this to 1 for local privacy.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.approximate_as_central_mechanism">
<span class="sig-name descname"><span class="pre">approximate_as_central_mechanism</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.approximate_as_central_mechanism" title="Link to this definition">#</a></dt>
<dd><p>Return an approximation of this mechanism that can be used as a central
mechanism.
To use this, imagine that <code class="docutils literal notranslate"><span class="pre">local_privacy</span></code> is the privacy mechanism to
be approximated:</p>
<blockquote>
<div><p>central_privacy = local_privacy.approximate_as_central_mechanism()
local_privacy = no_privacy</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">central_privacy</span></code> can then be passed into the backend as a central
privacy mechanism, which can significantly speed up simulations when
using local DP without affecting the outcomes of the simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentralPrivacyMechanism" title="pfl.privacy.privacy_mechanism.CentralPrivacyMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentralPrivacyMechanism</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A central privacy mechanism that approximates the local privacy
mechanism.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.approximate_mechanism.</span></span><span class="sig-name descname"><span class="pre">GaussianApproximatedPrivacyMechanism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_mechanism</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism" title="Link to this definition">#</a></dt>
<dd><p>Approximated version of a local privacy mechanism that can be applied as a
central mechanism. This can make simulations much faster (but cannot be used
in live training).</p>
<p>To use this, imagine that <code class="docutils literal notranslate"><span class="pre">local_mechanism</span></code> is the privacy mechanism to be
approximated and <code class="docutils literal notranslate"><span class="pre">local_mechanism_config</span></code> is its configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">central_mechanism</span> <span class="o">=</span> <span class="n">local_mechanism</span><span class="o">.</span><span class="n">approximate_as_central_mechanism</span><span class="p">()</span>
<span class="n">central_mechanism_config</span> <span class="o">=</span> <span class="n">local_mechanism_config</span>
<span class="n">local_mechanism</span> <span class="o">=</span> <span class="n">NoPrivacy</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">central_mechanism</span></code> can then be passed into the backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>local_mechanism</strong> (<a class="reference internal" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism" title="pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquaredErrorLocalPrivacyMechanism</span></code></a>) – The local mechanism to be approximated.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism.postprocess_one_user">
<span class="sig-name descname"><span class="pre">postprocess_one_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism.postprocess_one_user" title="Link to this definition">#</a></dt>
<dd><p>Do any postprocessing of client’s statistics before it is communicated
back to the server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – Statistics returned from the local training procedure of this user.</p></li>
<li><p><strong>user_context</strong> (<a class="reference internal" href="context.html#pfl.context.UserContext" title="pfl.context.UserContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserContext</span></code></a>) – Additional information about the current user.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(transformed_stats, metrics)</cite>, where <cite>transformed_stats</cite>
is <cite>stats</cite> after it is processed by the postprocessor, and
<cite>metrics</cite> is any new metrics to track. Default implementation
does nothing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism.postprocess_server">
<span class="sig-name descname"><span class="pre">postprocess_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism.postprocess_server" title="Link to this definition">#</a></dt>
<dd><p>Do any postprocessing of the aggregated statistics object after
central aggregation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>) – The aggregated statistics.</p></li>
<li><p><strong>central_context</strong> (<a class="reference internal" href="context.html#pfl.context.CentralContext" title="pfl.context.CentralContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">CentralContext</span></code></a>) – Information about aggregation and other useful server-side
properties.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="stats.html#pfl.stats.TrainingStatistics" title="pfl.stats.TrainingStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingStatistics</span></code></a>, <a class="reference internal" href="metrics.html#pfl.metrics.Metrics" title="pfl.metrics.Metrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <cite>(transformed_stats, metrics)</cite>, where <cite>transformed_stats</cite>
is <cite>stats</cite> after it is processed by the postprocessor, and
<cite>metrics</cite> is any new metrics to track. Default implementation
does nothing.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pfl.privacy.privacy_snr">
<span id="dp-metrics"></span><h2>DP metrics<a class="headerlink" href="#module-pfl.privacy.privacy_snr" title="Link to this heading">#</a></h2>
<p>Maintain and compute aggregate SNR metrics.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pfl.privacy.privacy_snr.SNRMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pfl.privacy.privacy_snr.</span></span><span class="sig-name descname"><span class="pre">SNRMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_l2_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_snr.SNRMetric" title="Link to this definition">#</a></dt>
<dd><p>A signal-to-noise metric for the Gaussian mechanism.</p>
<p>The “signal” is defined as the L2 norm of all statistics after clipping
but before adding the DP noise. Thus, the maximum value of the signal
is equal to the norm clipping bound.
The “noise” is defined as the L2 norm of the vector of standard deviations
of noise added to each statistic. Since the noise added to each parameter
has the same standard deviation <cite>noise_stddev</cite>, the overall noise is
defined as <cite>sqrt(num_dimensions) * noise_stddev</cite>.</p>
<p>All objects of type <code class="docutils literal notranslate"><span class="pre">SNRMetric</span></code> form a commutative monoid
(with <code class="docutils literal notranslate"><span class="pre">+</span></code> as the operator).
Intermediate values maintain two values.
The first is the sum of L2 norms from each data vector.
Note that the implicit assumption is that each data vector is in the same
direction, which is usually an overestimate.
The second is the sum of expected squared errors.
Note that the expected standard deviation of the noise can be computed from
this, but it does not sum.
(This is the reason that local DP with the Gaussian mechanism can be useful
at all.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_l2_norm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The L2 norm of the data vector.</p></li>
<li><p><strong>squared_error</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The expected squared L2 error that the mechanism has added to the
signal. This is summed over all elements of the vector, i.e.
it is equal to num_dimensions * noise_stddev**2 where noise_stddev
is the standard deviation of Gaussian noise added to each
statistic.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="pfl.privacy.privacy_snr.SNRMetric.signal_l2_norm">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">signal_l2_norm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#pfl.privacy.privacy_snr.SNRMetric.signal_l2_norm" title="Link to this definition">#</a></dt>
<dd><p>The (summed) L2 norm of the data vectors before adding noise.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pfl.privacy.privacy_snr.SNRMetric.squared_error">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">squared_error</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#pfl.privacy.privacy_snr.SNRMetric.squared_error" title="Link to this definition">#</a></dt>
<dd><p>The summed variance of the Gaussian noise that is added.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pfl.privacy.privacy_snr.SNRMetric.overall_value">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">overall_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#pfl.privacy.privacy_snr.SNRMetric.overall_value" title="Link to this definition">#</a></dt>
<dd><p>Return the overall value, e.g. an average or a total.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_snr.SNRMetric.to_vector">
<span class="sig-name descname"><span class="pre">to_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_snr.SNRMetric.to_vector" title="Link to this definition">#</a></dt>
<dd><p>Get a vector representation of this metric value, with
<code class="docutils literal notranslate"><span class="pre">dtype=float32</span></code>.
Summing two vectors in this space must be equivalent as summing the two
original objects.</p>
<p>This serializes only the signal norm and the noise variance.
The dimensionality is assumed to match.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pfl.privacy.privacy_snr.SNRMetric.from_vector">
<span class="sig-name descname"><span class="pre">from_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.privacy_snr.SNRMetric.from_vector" title="Link to this definition">#</a></dt>
<dd><p>Create a new metric value of this class from a vector representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pfl.privacy.privacy_snr.SNRMetric" title="pfl.privacy.privacy_snr.SNRMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNRMetric</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pfl.privacy.compute_parameters">
<span id="dp-utilities"></span><h2>DP utilities<a class="headerlink" href="#module-pfl.privacy.compute_parameters" title="Link to this heading">#</a></h2>
<p>Compute parameters for the Gaussian mechanism.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pfl.privacy.compute_parameters.AnalyticGM_robust_impl">
<span class="sig-prename descclassname"><span class="pre">pfl.privacy.compute_parameters.</span></span><span class="sig-name descname"><span class="pre">AnalyticGM_robust_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.compute_parameters.AnalyticGM_robust_impl" title="Link to this definition">#</a></dt>
<dd><p>Compute (optimally) the noise parameter (sigma) for the Gaussian mechanism,
for a given epsilon and delta.</p>
<p>This assumes the L2 sensitivity is 1.</p>
<p>Implements Algorithm 1 from
Balle and Wang (2018), “Improving the Gaussian Mechanism for Differential
Privacy: Analytical Calibration and Optimal Denoising”.
arXiv:1805.06530</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> – The ε parameter of approximate differential privacy.</p></li>
<li><p><strong>delta</strong> – The δ parameter of approximate differential privacy.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pfl.privacy.compute_parameters.AnalyticGM_robust">
<span class="sig-prename descclassname"><span class="pre">pfl.privacy.compute_parameters.</span></span><span class="sig-name descname"><span class="pre">AnalyticGM_robust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pfl.privacy.compute_parameters.AnalyticGM_robust" title="Link to this definition">#</a></dt>
<dd><p>Compute (optimally) the noise parameter (sigma) for the Gaussian mechanism,
for a given epsilon and delta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> – The ε parameter of approximate differential privacy.</p></li>
<li><p><strong>delta</strong> – The δ parameter of approximate differential privacy.</p></li>
<li><p><strong>k</strong> – The number of repetitions.
Note that it might be advantageous to use moments accountant instead
of this when k &gt; 1.</p></li>
<li><p><strong>l2</strong> – The L2 sensitivity.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="stats.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Training statistics</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="postprocessor.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Postprocessor</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024 Apple Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Jun 16, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Differential privacy</a><ul>
<li><a class="reference internal" href="#module-pfl.privacy.privacy_mechanism">Abstract base classes</a><ul>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.PrivacyMetricName"><code class="docutils literal notranslate"><span class="pre">PrivacyMetricName</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.PrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">PrivacyMechanism</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">LocalPrivacyMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.privatize"><code class="docutils literal notranslate"><span class="pre">LocalPrivacyMechanism.privatize()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_one_user"><code class="docutils literal notranslate"><span class="pre">LocalPrivacyMechanism.postprocess_one_user()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_server"><code class="docutils literal notranslate"><span class="pre">LocalPrivacyMechanism.postprocess_server()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.LocalPrivacyMechanism.postprocess_server_live"><code class="docutils literal notranslate"><span class="pre">LocalPrivacyMechanism.postprocess_server_live()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">SplitPrivacyMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.constrain_sensitivity"><code class="docutils literal notranslate"><span class="pre">SplitPrivacyMechanism.constrain_sensitivity()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.add_noise"><code class="docutils literal notranslate"><span class="pre">SplitPrivacyMechanism.add_noise()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.SplitPrivacyMechanism.privatize"><code class="docutils literal notranslate"><span class="pre">SplitPrivacyMechanism.privatize()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentrallyApplicablePrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">CentrallyApplicablePrivacyMechanism</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentralPrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">CentralPrivacyMechanism</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">CentrallyAppliedPrivacyMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_one_user"><code class="docutils literal notranslate"><span class="pre">CentrallyAppliedPrivacyMechanism.postprocess_one_user()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_server"><code class="docutils literal notranslate"><span class="pre">CentrallyAppliedPrivacyMechanism.postprocess_server()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.CentrallyAppliedPrivacyMechanism.postprocess_server_live"><code class="docutils literal notranslate"><span class="pre">CentrallyAppliedPrivacyMechanism.postprocess_server_live()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.NormClipping"><code class="docutils literal notranslate"><span class="pre">NormClipping</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.privacy_mechanism.NormClipping.constrain_sensitivity"><code class="docutils literal notranslate"><span class="pre">NormClipping.constrain_sensitivity()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#privacy-mechanisms">Privacy mechanisms</a><ul>
<li><a class="reference internal" href="#pfl.privacy.NoPrivacy"><code class="docutils literal notranslate"><span class="pre">NoPrivacy</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.NoPrivacy.constrain_sensitivity"><code class="docutils literal notranslate"><span class="pre">NoPrivacy.constrain_sensitivity()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.NoPrivacy.add_noise"><code class="docutils literal notranslate"><span class="pre">NoPrivacy.add_noise()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.NormClippingOnly"><code class="docutils literal notranslate"><span class="pre">NormClippingOnly</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism"><code class="docutils literal notranslate"><span class="pre">LaplaceMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.sensitivity_scaling"><code class="docutils literal notranslate"><span class="pre">LaplaceMechanism.sensitivity_scaling()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.sensitivity_squared_error"><code class="docutils literal notranslate"><span class="pre">LaplaceMechanism.sensitivity_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.add_noise_squared_error"><code class="docutils literal notranslate"><span class="pre">LaplaceMechanism.add_noise_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.laplace_mechanism.LaplaceMechanism.add_noise"><code class="docutils literal notranslate"><span class="pre">LaplaceMechanism.add_noise()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism"><code class="docutils literal notranslate"><span class="pre">GaussianMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.sensitivity_scaling"><code class="docutils literal notranslate"><span class="pre">GaussianMechanism.sensitivity_scaling()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.sensitivity_squared_error"><code class="docutils literal notranslate"><span class="pre">GaussianMechanism.sensitivity_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.add_noise_squared_error"><code class="docutils literal notranslate"><span class="pre">GaussianMechanism.add_noise_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.add_noise"><code class="docutils literal notranslate"><span class="pre">GaussianMechanism.add_noise()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.construct_single_iteration"><code class="docutils literal notranslate"><span class="pre">GaussianMechanism.construct_single_iteration()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.gaussian_mechanism.GaussianMechanism.from_privacy_accountant"><code class="docutils literal notranslate"><span class="pre">GaussianMechanism.from_privacy_accountant()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.ftrl_mechanism.FTRLMatrixFactorizer"><code class="docutils literal notranslate"><span class="pre">FTRLMatrixFactorizer</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.ftrl_mechanism.FTRLMatrixFactorizer.optimize"><code class="docutils literal notranslate"><span class="pre">FTRLMatrixFactorizer.optimize()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.ftrl_mechanism.ForwardSubstitution"><code class="docutils literal notranslate"><span class="pre">ForwardSubstitution</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.ftrl_mechanism.ForwardSubstitution.step"><code class="docutils literal notranslate"><span class="pre">ForwardSubstitution.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.ftrl_mechanism.BandedMatrixFactorizationMechanism"><code class="docutils literal notranslate"><span class="pre">BandedMatrixFactorizationMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.ftrl_mechanism.BandedMatrixFactorizationMechanism.add_noise"><code class="docutils literal notranslate"><span class="pre">BandedMatrixFactorizationMechanism.add_noise()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.joint_mechanism.JointMechanism"><code class="docutils literal notranslate"><span class="pre">JointMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.joint_mechanism.JointMechanism.constrain_sensitivity"><code class="docutils literal notranslate"><span class="pre">JointMechanism.constrain_sensitivity()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.joint_mechanism.JointMechanism.add_noise"><code class="docutils literal notranslate"><span class="pre">JointMechanism.add_noise()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#privacy-accountants">Privacy accountants</a><ul>
<li><a class="reference internal" href="#pfl.privacy.PrivacyAccountant"><code class="docutils literal notranslate"><span class="pre">PrivacyAccountant</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.PrivacyAccountant.cohort_noise_parameter"><code class="docutils literal notranslate"><span class="pre">PrivacyAccountant.cohort_noise_parameter</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.PLDPrivacyAccountant"><code class="docutils literal notranslate"><span class="pre">PLDPrivacyAccountant</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.PRVPrivacyAccountant"><code class="docutils literal notranslate"><span class="pre">PRVPrivacyAccountant</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.RDPPrivacyAccountant"><code class="docutils literal notranslate"><span class="pre">RDPPrivacyAccountant</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#joint-privacy-accountants">Joint Privacy accountants</a><ul>
<li><a class="reference internal" href="#pfl.privacy.JointPrivacyAccountant"><code class="docutils literal notranslate"><span class="pre">JointPrivacyAccountant</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.JointPrivacyAccountant.compute_for_each_mechanism"><code class="docutils literal notranslate"><span class="pre">JointPrivacyAccountant.compute_for_each_mechanism()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.JointPrivacyAccountant.cohort_noise_parameters"><code class="docutils literal notranslate"><span class="pre">JointPrivacyAccountant.cohort_noise_parameters</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.JointPrivacyAccountant.check_valid_parameter_settings"><code class="docutils literal notranslate"><span class="pre">JointPrivacyAccountant.check_valid_parameter_settings()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.privacy.adaptive_clipping">DP with adaptive clipping</a><ul>
<li><a class="reference internal" href="#pfl.privacy.adaptive_clipping.MutableClippingBound"><code class="docutils literal notranslate"><span class="pre">MutableClippingBound</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.adaptive_clipping.MutableClippingBound.value"><code class="docutils literal notranslate"><span class="pre">MutableClippingBound.value()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism"><code class="docutils literal notranslate"><span class="pre">AdaptiveClippingGaussianMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_one_user"><code class="docutils literal notranslate"><span class="pre">AdaptiveClippingGaussianMechanism.postprocess_one_user()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_server"><code class="docutils literal notranslate"><span class="pre">AdaptiveClippingGaussianMechanism.postprocess_server()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.postprocess_server_live"><code class="docutils literal notranslate"><span class="pre">AdaptiveClippingGaussianMechanism.postprocess_server_live()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.adaptive_clipping.AdaptiveClippingGaussianMechanism.construct_from_privacy_accountant"><code class="docutils literal notranslate"><span class="pre">AdaptiveClippingGaussianMechanism.construct_from_privacy_accountant()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.privacy.approximate_mechanism">Approximate local DP with central DP</a><ul>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">SquaredErrorLocalPrivacyMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.sensitivity_scaling"><code class="docutils literal notranslate"><span class="pre">SquaredErrorLocalPrivacyMechanism.sensitivity_scaling()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.sensitivity_squared_error"><code class="docutils literal notranslate"><span class="pre">SquaredErrorLocalPrivacyMechanism.sensitivity_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.add_noise_squared_error"><code class="docutils literal notranslate"><span class="pre">SquaredErrorLocalPrivacyMechanism.add_noise_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.get_squared_error"><code class="docutils literal notranslate"><span class="pre">SquaredErrorLocalPrivacyMechanism.get_squared_error()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.SquaredErrorLocalPrivacyMechanism.approximate_as_central_mechanism"><code class="docutils literal notranslate"><span class="pre">SquaredErrorLocalPrivacyMechanism.approximate_as_central_mechanism()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism"><code class="docutils literal notranslate"><span class="pre">GaussianApproximatedPrivacyMechanism</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism.postprocess_one_user"><code class="docutils literal notranslate"><span class="pre">GaussianApproximatedPrivacyMechanism.postprocess_one_user()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.approximate_mechanism.GaussianApproximatedPrivacyMechanism.postprocess_server"><code class="docutils literal notranslate"><span class="pre">GaussianApproximatedPrivacyMechanism.postprocess_server()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.privacy.privacy_snr">DP metrics</a><ul>
<li><a class="reference internal" href="#pfl.privacy.privacy_snr.SNRMetric"><code class="docutils literal notranslate"><span class="pre">SNRMetric</span></code></a><ul>
<li><a class="reference internal" href="#pfl.privacy.privacy_snr.SNRMetric.signal_l2_norm"><code class="docutils literal notranslate"><span class="pre">SNRMetric.signal_l2_norm</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_snr.SNRMetric.squared_error"><code class="docutils literal notranslate"><span class="pre">SNRMetric.squared_error</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_snr.SNRMetric.overall_value"><code class="docutils literal notranslate"><span class="pre">SNRMetric.overall_value</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_snr.SNRMetric.to_vector"><code class="docutils literal notranslate"><span class="pre">SNRMetric.to_vector()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.privacy_snr.SNRMetric.from_vector"><code class="docutils literal notranslate"><span class="pre">SNRMetric.from_vector()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-pfl.privacy.compute_parameters">DP utilities</a><ul>
<li><a class="reference internal" href="#pfl.privacy.compute_parameters.AnalyticGM_robust_impl"><code class="docutils literal notranslate"><span class="pre">AnalyticGM_robust_impl()</span></code></a></li>
<li><a class="reference internal" href="#pfl.privacy.compute_parameters.AnalyticGM_robust"><code class="docutils literal notranslate"><span class="pre">AnalyticGM_robust()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=4621528c"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>